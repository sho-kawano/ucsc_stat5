---
title: "Code for all problems"
author: "Sho Kawano"
date: "2024-07-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


##Problem 2

```{r}
set.seed(7)
data <- read.csv("data/538_wnba/simplified_data.csv") 
data %>% sample_n(10) %>% select(player_ID, Player, year=year_ID, Age, Team=Tm, Games=G, Position=Pos, Minutes=MP, True_Shooting_Pct=TS_pct) %>% 
  write.csv("figs+tables/wk1/wk1_p2.csv", row.names = F)
```


##Problem 3

```{r}
days <- 1:7
salmon <- c(7, 8, 19, 9, 11, 10, 16)

par(mfrow = c(1,1), mar=c(5, 3, 3, 3))
hist(salmon, xlab="Number of Salmon caught", main="Distribution of salmon caught over 7 days", ylab="Count", col="lightblue") 
```

```{r}
sum(salmon)
mean(salmon)
```



##Problem 5


```{r}
data <- read.csv("data/538_wnba/simplified_data.csv") 
plt <- data %>% ggplot(aes(x=TS_pct)) + 
  geom_histogram(bins=20, color="blue", fill="lightblue") + theme_bw() +
  labs(title="Distribution of True Shooting Percentage by WNBA players", 
       subtitle = "1997-2019 Seasons") + 
  xlab("True Shooting Percentage") 
plt %>% ggsave(file="figs+tables/wk1/fig_p3.png", height = 3, width=6)
```


##Problem 6


```{r}
histplt <- iris %>% ggplot(aes(x=Petal.Length)) + 
   geom_histogram(bins=20, color="blue", fill="lightblue") + 
   theme_bw() +
   labs(title="Petal Length of Iris Flowers") + 
   xlab("Petal Length") 
 
boxplt <- iris %>% ggplot(aes(x=Petal.Length)) + 
   geom_boxplot(color="blue", fill="lightblue", alpha=0.3, ymax=0.1, ymin=-0.1) + 
   theme_bw() +
   theme(axis.text.y=element_blank())+
   xlab("Petal Length") 
 
histplt + boxplt

(histplt + boxplt) %>% ggsave(file="figs+tables/wk2/fig2.png", height = 2.5, width=6)
```


```{r}
boxplt <- iris %>% ggplot(aes(x=Petal.Length, y=Species, fill=Species, colour = Species)) + 
   geom_boxplot(alpha=0.5) + 
   theme_bw() +
   xlab("Petal Length") 
boxplt
boxplt %>% ggsave(file="figs+tables/wk2/fig3.png", height = 2.5, width=6)
```

##Problem 7

```{r}
diabetes <- c(6, 8, 25, 11, 5, 9, 6)
sum(diabetes)
mean(diabetes)
median(diabetes)
```

```{r}
boxplot(diabetes)
```


```{r}
diabetes <- c(6, 8, 25)
sum(diabetes)
mean(diabetes)
median(diabetes)
```


```{r}
mean(diabetes[diabetes<24])
median(diabetes[diabetes<24])
```



##Problem 8


```{r }
library(taylor)
duration = taylor_all_songs$duration_ms / 60000 # in minutes
duration = duration[!is.na(duration)]

par(mfrow = c(1,1), mar=c(5, 5, 3, 3))
hist(duration, main="Duration of all Taylor Swift Songs", 
     xlab="Song Duration in Minutes", ylab="Count", col="lightblue")
```


```{r}
par(mfrow = c(1,1), mar=c(5, 5, 3, 3))
hist(duration, main="Duration of all Taylor Swift Songs", xlab="Song Duration in Minutes", ylab="Count", col="lightblue")
abline(v=quantile(duration, 0.1), lty=2, lw=2, col="blue")
# abline(v=quantile(duration, 0.5), lty=2, lw=2, col="blue")
abline(v=quantile(duration, 0.95), lty=2, lw=2, col="blue")
```


##Problem 9

```{r}
data("storms")
storms %>% head()
```


```{r}
by_storms = storms %>% group_by(name, year) %>% summarise(wind=max(wind)) 
```



```{r}
windspeed = by_storms$wind
par(mfrow = c(1,1), mar=c(5, 5, 3, 3))
hist(windspeed, main="Max Windspeed for all Atlantic storms", 
     xlab="Maximum Observed Windspeed (knots)", ylab="Count", col="lightblue")
```

```{r}
summary(windspeed)
```

```{r}
mode0 <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

mode0(windspeed)
```


```{r}
sd(windspeed)
IQR(windspeed)
max(windspeed) - min(windspeed)
```

